<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Verbaly - Dashboard</title>
  <link rel="manifest" href="./manifest.json" />
  <meta name="theme-color" content="#007bff" />
  <style>
    /* Copia qui i tuoi stili (da index.html) */
  </style>
</head>
<body>
  <!-- Verifico che l'utente sia loggato -->
  <script>
    auth.onAuthStateChanged(user => {
      if (!user) {
               window.location.href = 'login.html';
      }
    });
  </script>

  <div id="mainApp">
    <h1>Verbaly - Registrazione Assemblea</h1>

    <!-- ‚Ä¶ qui tutto il contenuto che avevi in index.html (tranne login) ‚Ä¶ -->

    <!-- esempio: pulsante logout -->
    <button onclick="auth.signOut(); window.location.href='login.html';">Logout</button>

    <!-- segue tutto il resto: gestione speaker, trascrizione, votazioni, archivio ‚Ä¶ -->
    <div id="speakerSection" style="margin-bottom: 15px;">
      <input type="text" id="newSpeaker" placeholder="Inserisci nome voce (es. Amministratore)" />
      <button onclick="addSpeaker()">Aggiungi Voce</button>
      <select id="speakerSelect"></select>
      <button onclick="changeSpeaker()" id="changeSpeakerBtn" style="display:none;">Cambia Voce</button>
    </div>

    <button onclick="startRecording()" id="recordBtn">Registra</button>
    <button onclick="stopRecording()" id="stopBtn" disabled>Ferma</button>
    <button onclick="downloadTranscript()" id="downloadBtn">Scarica Verbale</button>
    <button onclick="clearTranscript()">Pulisci Verbale</button><br>

    <label>üìé Allega documenti: <input type="file" id="attachments" multiple /></label>
    <div id="transcript" contenteditable="true">Qui apparir√† la trascrizione...</div>

    <div id="privacyBlock">
      <h2>Informativa Privacy</h2>
      <p>Ai sensi del Regolamento UE 2016/679 (GDPR)‚Ä¶</p>
      <p>‚Ä¶</p>
    </div>

    <div id="archiveIcon" ondblclick="toggleArchive()">üìÅ Archivio Assemblee</div>
    <div id="archiveList"></div>

    <button onclick="toggleVoting()" id="voteBtn" style="display:none;">üó≥Ô∏è Nuova Votazione</button>
    <div id="votingSection" style="display:none; border:1px solid #ccc; padding:10px; margin-top:10px;">
      <h3>Nuova Votazione</h3>
      <input type="text" id="voteQuestion" placeholder="Domanda della votazione" /><br />
      <input type="text" id="option1" placeholder="Opzione 1" />
      <input type="text" id="option2" placeholder="Opzione 2" /><br />
      <button onclick="launchVoting()" id="launchBtn">Avvia Votazione</button>
      <button onclick="castVote()" id="castBtn" style="display:none;">Vota</button>
      <button onclick="reportVote()" id="reportBtn" style="display:none;">Report Votazione</button>
      <div id="voteResults"></div>
    </div>

    <div id="calendarSection" style="display:none; border:1px solid #ccc; padding:10px; margin-top:10px;">
      <h3>Nuovo Programma Assemblea</h3>
      <input type="text" id="title" placeholder="Titolo Assembly" /><br />
      <input type="datetime-local" id="datetime" /><br />
      <input type="text" id="location" placeholder="Luogo" /><br />
      <textarea id="notes" placeholder="Note" rows="3" cols="30"></textarea><br />
      <button onclick="saveMeeting()">Salva Assemblea</button>
      <div id="calendarList"></div>
    </div>
  </div>

 <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
<script src="./firebaseConfig.js"></script>

  <script src="./script.js"></script>
<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('/sw.js')
        .then(reg => console.log('SW registrato con scope:', reg.scope))
        .catch(err => console.warn('SW registration failed:', err));
    });
  }
</script>
</body>
</html>
